<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Waiting Room - Contract Crown</title>
    <link rel="stylesheet" href="src/styles/main.css">
    <link rel="stylesheet" href="src/styles/waiting-room.css">
    <style>
        /* Quick test styles */
        body { margin: 20px; }
        .test-info { 
            background: #f0f0f0; 
            padding: 10px; 
            margin-bottom: 20px; 
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="test-info">
        <h3>Waiting Room Test Page</h3>
        <p>This page tests the new waiting room layout with:</p>
        <ul>
            <li>Ready buttons moved to player slots</li>
            <li>Team management with drag & drop</li>
            <li>Bot management</li>
            <li>Ready status in host controls</li>
        </ul>
    </div>

    <div id="app">
        <!-- Header -->
        <header class="waiting-room-header">
            <div class="header-content">
                <div class="header-left">
                    <button id="leave-room-btn" class="btn btn-secondary btn-sm">
                        <span class="btn-icon">‚Üê</span>
                        Leave Room
                    </button>
                </div>
                <div class="header-center">
                    <h1 class="room-title">Waiting Room</h1>
                    <div class="room-code-display">
                        <span class="room-code-label">Room Code:</span>
                        <span id="room-code" class="room-code">TEST123</span>
                        <button id="copy-code-btn" class="copy-btn">
                            <span class="copy-icon">üìã</span>
                        </button>
                    </div>
                </div>
                <div class="header-right">
                    <div id="connection-status" class="connection-status">
                        <span class="status-indicator connected" id="status-indicator"></span>
                        <span class="status-text" id="status-text">Connected</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="waiting-room-main">
            <div class="waiting-room-container">
                <!-- Player Slots Section -->
                <section class="players-section">
                    <div class="section-header">
                        <h2>Players</h2>
                        <div class="players-count">
                            <span id="current-players">2</span>/4
                        </div>
                    </div>
                    
                    <div class="players-grid">
                        <!-- Player Slot 1 -->
                        <div class="player-slot occupied ready" id="player-slot-1" data-position="1" draggable="true" data-player-id="player1">
                            <div class="player-avatar">
                                <div class="avatar-placeholder">J</div>
                            </div>
                            <div class="player-info">
                                <div class="player-name">John Doe</div>
                                <div class="player-status">
                                    <span class="ready-indicator"></span>
                                    <span class="ready-text">Ready</span>
                                </div>
                            </div>
                            <div class="player-actions">
                                <button class="ready-btn ready" data-slot="1">
                                    <span class="ready-btn-text">Ready</span>
                                </button>
                                <div class="player-badges">
                                    <span class="host-badge">Host</span>
                                </div>
                            </div>
                        </div>

                        <!-- Player Slot 2 -->
                        <div class="player-slot occupied" id="player-slot-2" data-position="2" draggable="true" data-player-id="player2">
                            <div class="player-avatar">
                                <div class="avatar-placeholder">A</div>
                            </div>
                            <div class="player-info">
                                <div class="player-name">Alice Smith</div>
                                <div class="player-status">
                                    <span class="ready-indicator"></span>
                                    <span class="ready-text">Not Ready</span>
                                </div>
                            </div>
                            <div class="player-actions">
                                <button class="ready-btn" data-slot="2">
                                    <span class="ready-btn-text">Ready</span>
                                </button>
                                <div class="player-badges">
                                    <span class="host-badge hidden">Host</span>
                                </div>
                            </div>
                        </div>

                        <!-- Player Slot 3 -->
                        <div class="player-slot" id="player-slot-3" data-position="3">
                            <div class="player-avatar">
                                <div class="avatar-placeholder">3</div>
                            </div>
                            <div class="player-info">
                                <div class="player-name">Waiting for player...</div>
                                <div class="player-status">
                                    <span class="ready-indicator"></span>
                                    <span class="ready-text">Not Ready</span>
                                </div>
                            </div>
                            <div class="player-actions">
                                <button class="ready-btn hidden" data-slot="3">
                                    <span class="ready-btn-text">Ready</span>
                                </button>
                                <div class="player-badges">
                                    <span class="host-badge hidden">Host</span>
                                </div>
                            </div>
                        </div>

                        <!-- Player Slot 4 -->
                        <div class="player-slot" id="player-slot-4" data-position="4">
                            <div class="player-avatar">
                                <div class="avatar-placeholder">4</div>
                            </div>
                            <div class="player-info">
                                <div class="player-name">Waiting for player...</div>
                                <div class="player-status">
                                    <span class="ready-indicator"></span>
                                    <span class="ready-text">Not Ready</span>
                                </div>
                            </div>
                            <div class="player-actions">
                                <button class="ready-btn hidden" data-slot="4">
                                    <span class="ready-btn-text">Ready</span>
                                </button>
                                <div class="player-badges">
                                    <span class="host-badge hidden">Host</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Team Management Section -->
                <section class="team-management-section">
                    <div class="section-header">
                        <h2>Team Management</h2>
                        <div class="team-info">
                            <span class="team-info-text">Drag players to assign teams</span>
                        </div>
                    </div>
                    
                    <div class="teams-container">
                        <!-- Team A -->
                        <div class="team-section" id="team-a-section">
                            <div class="team-header">
                                <h3 class="team-title">Team A</h3>
                                <span class="team-count" id="team-a-count">1/2</span>
                            </div>
                            <div class="team-slots" id="team-a-slots" data-team="A">
                                <div class="team-slot occupied" data-slot="a1">
                                    <div class="team-player-info">
                                        <div class="team-player-name">John Doe</div>
                                        <div class="team-player-status">‚úì</div>
                                    </div>
                                </div>
                                <div class="team-slot empty" data-slot="a2">
                                    <div class="slot-placeholder">Drop player here</div>
                                </div>
                            </div>
                        </div>

                        <!-- Team B -->
                        <div class="team-section" id="team-b-section">
                            <div class="team-header">
                                <h3 class="team-title">Team B</h3>
                                <span class="team-count" id="team-b-count">1/2</span>
                            </div>
                            <div class="team-slots" id="team-b-slots" data-team="B">
                                <div class="team-slot occupied" data-slot="b1">
                                    <div class="team-player-info">
                                        <div class="team-player-name">Alice Smith</div>
                                        <div class="team-player-status">‚óã</div>
                                    </div>
                                </div>
                                <div class="team-slot empty" data-slot="b2">
                                    <div class="slot-placeholder">Drop player here</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Bot Management -->
                    <div class="bot-management" id="bot-management">
                        <div class="bot-controls">
                            <button id="add-bots-btn" class="btn btn-secondary">
                                <span class="btn-icon">ü§ñ</span>
                                <span class="btn-text">Add Bots</span>
                                <span class="bot-count" id="bot-count-display">(0)</span>
                            </button>
                            <div class="bot-info">
                                <span class="bot-info-text">Bots will fill remaining slots automatically</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Host Controls Section -->
                <section class="host-controls-section" id="host-controls">
                    <div class="host-controls">
                        <!-- Ready Status Info -->
                        <div class="ready-status-info">
                            <div class="ready-status some-ready">
                                <span class="ready-count-display">
                                    <span id="ready-count">1</span> of <span id="total-players">2</span> players ready
                                </span>
                            </div>
                            <div class="game-requirements" id="game-requirements">
                                <span class="requirement-text met">‚úì 2 human players ready to start</span>
                            </div>
                        </div>

                        <!-- Game Controls -->
                        <div class="game-controls">
                            <button id="start-game-btn" class="btn btn-primary btn-lg" disabled>
                                <span class="btn-text">Start Game</span>
                                <span id="start-spinner" class="spinner hidden"></span>
                            </button>
                            <button id="reset-to-waiting-btn" class="btn btn-secondary btn-lg hidden">
                                <span class="btn-text">Return to Waiting Room</span>
                                <span id="reset-spinner" class="spinner hidden"></span>
                            </button>
                        </div>

                        <div class="host-info">
                            <span class="host-text">You are the host - manage teams and start when ready</span>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script>
        // Simple test script to demonstrate functionality
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Test waiting room loaded');
            
            // Test ready button clicks
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('ready-btn') || e.target.closest('.ready-btn')) {
                    const btn = e.target.classList.contains('ready-btn') ? e.target : e.target.closest('.ready-btn');
                    btn.classList.toggle('ready');
                    const text = btn.querySelector('.ready-btn-text');
                    if (text) {
                        text.textContent = btn.classList.contains('ready') ? 'Ready' : 'Ready';
                    }
                    console.log('Ready button clicked for slot:', btn.dataset.slot);
                }
            });

            // Test bot management
            document.getElementById('add-bots-btn')?.addEventListener('click', () => {
                console.log('Add bots clicked');
                alert('Bot management functionality would be triggered here');
            });

            // Test drag and drop
            let draggedElement = null;
            
            document.addEventListener('dragstart', (e) => {
                if (e.target.classList.contains('player-slot') && e.target.dataset.playerId) {
                    draggedElement = e.target;
                    e.target.classList.add('dragging');
                    console.log('Drag started for player:', e.target.dataset.playerId);
                }
            });

            document.addEventListener('dragend', (e) => {
                if (e.target.classList.contains('player-slot')) {
                    e.target.classList.remove('dragging');
                    draggedElement = null;
                }
            });

            document.addEventListener('dragover', (e) => {
                if (e.target.classList.contains('team-slot') || e.target.closest('.team-slot')) {
                    e.preventDefault();
                    const slot = e.target.classList.contains('team-slot') ? e.target : e.target.closest('.team-slot');
                    slot.classList.add('drag-over');
                }
            });

            document.addEventListener('dragleave', (e) => {
                if (e.target.classList.contains('team-slot') || e.target.closest('.team-slot')) {
                    const slot = e.target.classList.contains('team-slot') ? e.target : e.target.closest('.team-slot');
                    slot.classList.remove('drag-over');
                }
            });

            document.addEventListener('drop', (e) => {
                e.preventDefault();
                if (e.target.classList.contains('team-slot') || e.target.closest('.team-slot')) {
                    const slot = e.target.classList.contains('team-slot') ? e.target : e.target.closest('.team-slot');
                    slot.classList.remove('drag-over');
                    
                    if (draggedElement) {
                        const playerId = draggedElement.dataset.playerId;
                        const team = slot.closest('.team-slots').dataset.team;
                        const slotId = slot.dataset.slot;
                        
                        console.log('Drop:', { playerId, team, slotId });
                        alert(`Would assign player ${playerId} to team ${team} slot ${slotId}`);
                    }
                }
            });
        });
    </script>
</body>
</html>